{% extends "base.html" %}

{% block title %}HR Dashboard{% endblock %}

{% block nav %}
<a href="/employer/post_job">Post Job</a>
{% endblock %}

{% block content %}
<div class="employer">
	<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>  
    <script>var $j = jQuery.noConflict();</script>
	<div>{{errorMsg}}</div>
	<div>
		<form action="/employer/empSearch" method="POST">
			<div class="category">
				<label for="category">Enter Category : </label>
				<input type="text" name="category" id="category">
			</div>
			<div>
				<input type="submit" name="submit" value="Search">
			</div>
		</form>
	</div>
	<div>
		<table>
			<thead>
				<tr>
					<th>No</th>
					<th>Name</th>
					<th>Email</th>
					<th>Details</th>
				</tr>
			</thead>
			<tbody>
				{% for i in range(0, data|length) %}
					<tr>
						<td>{{ (i+1) }}</td>
						<td>{{ data[i]['name'] }}</td>
						<td>{{ data[i]['email'] }}</td>
						<td><input type="button" name="view" value="View" id="{{data[i]['_id']}}" data-bs-toggle="modal" data-bs-target="#viewdetails"  class="view_data"/></td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<div class="modal fade" id="viewdetails" tabindex="-1" role="dialog" aria-labelledby="viewdetails" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h3 class="modal-title" id="exampleModalLongTitle">Details of Candidate:</h3>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<table>
						<tr> 
							<td><label>Name:</label></td>   
							<td><input type="text" class="form-control-plaintext" readonly  id="view_name"></td> 
						</tr>
						<tr> 
							<td><label>Email:</label></td>   
							<td><input type="text" class="form-control-plaintext" readonly id="view_email"></td>
						</tr>
						<tr> 
							<td><label>Mobile No.:</label></td>  
							<td><input type="text" class="form-control-plaintext" readonly id="view_mobile"></td> 
						</tr>
						<tr> 
							<td><label>Skills:</label></td>  
							<td><textarea rows="3" cols="70" class="form-control-plaintext" readonly id="view_skills" ></textarea></td>
						</tr>
						<tr> 
							<td><label>Education:</label></td>   
							<td><input type="text" class="form-control-plaintext" readonly  id="view_education"> </td>
						</tr>
					</table>
				</div>
			</div>
		</div>
	</div>
	<script>
		$(document).on('click', '.view_data', function() {
			var employee_id = $(this).attr('id');
			$j.ajax({
				url: '/employer/viewDetails',
				method: 'POST',
				data: ({ employee_id : employee_id }),
				success: function(data) {
					console.log(data);
					$('#view_name').val(data.name);
					$('#view_email').val(data.email);
        			$('#view_mobile').val(data.mobile_number);
        			$('#view_skills').val(data.skills);
        			$('#view_education').val(data.education);
				}
			})
		})
	</script>
</div>
{% endblock %}
